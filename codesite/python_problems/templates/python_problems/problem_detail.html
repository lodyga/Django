{% extends "core/base.html" %}
{% block title %}
Python
{% endblock title %}
{% block content %}
{% comment %} {% load static %}
<link rel="stylesheet" href="{% static 'python_problems/style.css' %}"> {% endcomment %}
  <div class="container-fluid m-2">
    <div class="row">
      <div class="col-md-2">
        <div class="col sticky-top">
          <div class="row">
            <div>
              <a href="{% url 'python_problems:index' %}"
                 class="btn btn-secondary px-3 py-0 mb-2">Back</a>
            </div>
          </div>
          <div class="row">
            <div>
              <button type="button"
                      class="btn btn-primary px-3 py-1 mb-2"
                      data-bs-toggle="collapse"
                      data-bs-target="#related">Show related problems</button>
              <div id="related" class="collapse">
                <p>
                  <b>Related Problems</b>:
                </p>
                <div class="box">
                  <ul>
                    {% for related in related_problems %}
                      <li>
                        <a href="{% url 'python_problems:detail' related.id %}">
                          {% if related.title|length > 30 %}
                            {{ related.title|slice:":27" }} ...
                          {% else %}
                            {{ related.title }}
                          {% endif %}
                        </a>
                      </li>
                    {% endfor %}
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-8">
        <div class="container">
          <div class="row">
            <div class="col-auto mb-5 mt-5">
              <h1>{{ problem.title }}</h1>
              <hr>
            </div>
            <div class="row">
              <div class="col-auto mb-2">
                <p>
                  <b>Difficulty</b>:
                  <p>{{ problem.difficulty }}</p>
                </p>
              </div>
              <div class="col-auto mb-2">
                <p>
                  <b>Tags</b>:
                  {% comment %}<p>{{ tags|join:", " }}</p>{% endcomment %}
                  <p>
                    {% for tag in tags %}
                      <a href="{% url 'python_problems:index' %}?query={{ tag }}">{{ tag }}</a>
                      {% if not forloop.last %},{% endif %}
                    {% endfor %}
                  </p>
                </p>
              </div>
              <div class="col-auto mb-2">
                <p>
                  <b>Complexity</b>:
                </p>
                {% comment %}<a href="{{ problem.time_complexity }}">Time {{ problem.time_complexity }}</a>
                <a href="{{ problem.space_complexity }}">Space: {{ problem.space_complexity }}</a>{% endcomment %}
                <p>Time: {{ problem.time_complexity }}, Space: {{ problem.space_complexity }}</p>
              </div>
              <div class="col-auto mb-2">
                <p>
                  <b>URL</b>:
                </p>
                <a href="{{ problem.url }}">{{ problem.url|slice:"8:20" }}</a>
              </div>
            </div>
          </div>
          <hr>
          <p>
            <b>Problem description</b>:
          </p>
          <pre style="white-space: pre-wrap">{{ problem.description }}</pre>
          <br>
          <hr>


          {% load crispy_forms_tags %}
          <form id="code_form_id" action="{% url 'python_problems:detail' problem.id %}" method="POST" class="mb-5">
              {% csrf_token %}
              {{ code_form|crispy }}
              <button id="submitButton" type="submit" class="btn btn-warning">
                  <span id="spinner" class="spinner-border spinner-border-sm d-none"></span>
                  Run
              </button>
          </form>

          <script>
              document.getElementById('code_form_id').addEventListener('submit', function () {
                  document.getElementById('submitButton').disabled = true; // Disable the submit button
                  document.getElementById('spinner').classList.remove('d-none'); // Show the spinner
                  document.getElementById('submitButton').innerHTML = '<span class="spinner-border spinner-border-sm"></span> Running';
              });
          </script>

      




          <form action="" class="mb-3">
            {{ output_form|crispy }}
          </form>


          

          {% comment %} <pre>{{ processed_code }}</pre> {% endcomment %}
          <br>
          <hr>
          <p>
            <b>Test Cases</b>:
          </p>
          <pre>{{ problem.testcase }}</pre>
          <br>
          <hr>
          <button type="button"
                  class="btn btn-primary mb-2"
                  data-bs-toggle="collapse"
                  data-bs-target="#solution">Show solution</button>
          <div id="solution" class="collapse">
            <p>
              <b>Solution</b>:
            </p>
            <div class="box">
              <pre>{{ problem.solution }}</pre>
            </div>
          </div>
          <br>
          <hr>
        </div>
      </div>
      <div class="col-md-2">
        <div class="row"></div>
        <div class="row">
          <div>
            <a href="{% url 'python_problems:index' %}"
               class="btn btn-secondary px-3 py-1 mb-2">Back</a>
          </div>
        </div>
      </div>
    </div>
  </div>
{% endblock content %}
