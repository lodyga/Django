{% extends "core/base.html" %}
{% block title %}
Python
{% endblock title %}
{% block content %}
{% comment %} {% load static %}
<link rel="stylesheet" href="{% static 'python_problems/style.css' %}"> {% endcomment %}
  <div class="container-fluid m-2">
    <div class="row">
      <div class="col-md-2">
        <div class="col sticky-top">
          <div class="row">
            <div>
              <a href="{% url 'python_problems:index' %}"
                 class="btn btn-secondary px-3 py-0 mb-2">Back</a>
            </div>
          </div>
          <div class="row">
            <div>
              <button type="button"
                      class="btn btn-primary px-3 py-1 mb-2"
                      data-bs-toggle="collapse"
                      data-bs-target="#related">Show related problems</button>
              <div id="related" class="collapse">
                <p>
                  <b>Related Problems</b>:
                </p>
                <div class="box">
                  <ul>
                    {% for related in related_problems %}
                      <li>
                        <a href="{% url 'python_problems:detail' related.id %}">
                          {% if related.title|length > 30 %}
                            {{ related.title|slice:":27" }} ...
                          {% else %}
                            {{ related.title }}
                          {% endif %}
                        </a>
                      </li>
                    {% endfor %}
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-8">
        <div class="container">
          <div class="row">
            <div class="col-auto mb-5 mt-5">
              <h1>{{ problem.title }}</h1>
              <hr>
            </div>
            <div class="row">
              <div class="col-auto mb-2">
                <p>
                  <b>Difficulty</b>:
                  <p>{{ problem.difficulty }}</p>
                </p>
              </div>
              <div class="col-auto mb-2">
                <p>
                  <b>Tags</b>:
                  {% comment %}<p>{{ tags|join:", " }}</p>{% endcomment %}
                  <p>
                    {% for tag in tags %}
                      <a href="{% url 'python_problems:index' %}?query={{ tag }}">{{ tag }}</a>
                      {% if not forloop.last %},{% endif %}
                    {% endfor %}
                  </p>
                </p>
              </div>
              <div class="col-auto mb-2">
                <p>
                  <b>Complexity</b>:
                </p>
                {% comment %}<a href="{{ problem.time_complexity }}">Time {{ problem.time_complexity }}</a>
                <a href="{{ problem.space_complexity }}">Space: {{ problem.space_complexity }}</a>{% endcomment %}
                <p>Time: {{ problem.time_complexity }}, Space: {{ problem.space_complexity }}</p>
              </div>
              <div class="col-auto mb-2">
                <p>
                  <b>URL</b>:
                </p>
                <a href="{{ problem.url }}">{{ problem.url|slice:"8:20" }}</a>
              </div>
            </div>
          </div>
          <hr>
          <p>
            <b>Problem description</b>:
          </p>
          <pre style="white-space: pre-wrap">{{ problem.description }}</pre>
          <br>
          <hr>





          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.63.0/codemirror.min.css">
          <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/codemirror@5.62.0/theme/monokai.css">
          <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.63.0/codemirror.min.js"></script>
          <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.63.0/mode/python/python.min.js"></script>
          
          {% load crispy_forms_tags %}
{% comment %}           <form id="code_form_id" action="{% url 'python_problems:detail' problem.id %}" method="POST" class="mb-5">
              {% csrf_token %}
              <div class="code-area-container mb-2">
                <label for="id_code_area">Code Area</label>
                {{ code_form.code_area }}
              </div>
                <button id="submitButton" type="submit" class="btn btn-warning">
                  Run
                </button>
                
                
          </form>

          <script>
            var editor = CodeMirror.fromTextArea(document.getElementById("id_code_area"), {
                mode: "python",
                
                lineNumbers: true, // Enable line numbers
                autofocus: true // Automatically focus on the editor
            });
          </script>
 {% endcomment %}





 <form id="code_form_id" action="{% url 'python_problems:detail' problem.id %}" method="POST" class="mb-5">
  {% csrf_token %}
  <div class="code-area-container mb-2">
    <label for="id_code_area">Code Area</label>
    <textarea name="code_area" id="id_code_area" cols="80" rows="10" class="python-code" required>{{ code_form.code_area.field.widget.attrs.placeholder  }}</textarea>
  </div>
  <button id="submitButton" type="submit" class="btn btn-warning">
    Run
  </button>
</form>

<script>
  // Function to initialize CodeMirror
  function initializeCodeMirror() {
    var editor = CodeMirror.fromTextArea(document.getElementById("id_code_area"), {
      mode: "python",
      lineNumbers: true,
      autofocus: true
    });

    // Hide the original textarea after CodeMirror initialization
    document.getElementById("id_code_area").style.display = "none";
  }

  // Initialize CodeMirror when DOM content is loaded
  document.addEventListener("DOMContentLoaded", function() {
    initializeCodeMirror();
  });
</script>






          {% load crispy_forms_tags %}
          <form action="" class="mb-3">
            {{ output_form|crispy }}
          </form>


          

          {% comment %} <pre>{{ processed_code }}</pre> {% endcomment %}
          <br>
          <hr>
          <p>
            <b>Test Cases</b>:
          </p>
          <pre>{{ problem.testcase }}</pre>
          <br>
          <hr>
          <button type="button"
                  class="btn btn-primary mb-2"
                  data-bs-toggle="collapse"
                  data-bs-target="#solution">Show solution</button>
          <div id="solution" class="collapse">
            <p>
              <b>Solution</b>:
            </p>
            <div class="box">
              <pre>{{ problem.solution }}</pre>
            </div>
          </div>
          <br>
          <hr>
        </div>
      </div>
      <div class="col-md-2">
        <div class="row"></div>
        <div class="row">
          <div>
            <a href="{% url 'python_problems:index' %}"
               class="btn btn-secondary px-3 py-1 mb-2">Back</a>
          </div>
        </div>
      </div>
    </div>
  </div>

  
{% endblock content %}
