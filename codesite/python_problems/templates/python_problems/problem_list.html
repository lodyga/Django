{% extends "core/base.html" %}
{% block title %}
  Python
{% endblock title %}
{% block content %}
  {% load static %}
  <link rel="stylesheet" href="{% static 'python_problems/style.css' %}">
  <h2>Python problems list</h2>
  <a href="/" class="btn btn-secondary px-3 py-0 m-1">Back</a>
  <br>
  <a href="create/" class="ms-4">Create a problem</a> |
  <a href="tag/">Tag list</a> |
  <a href="tag/create/">Add a tag</a>
  <hr>
  <div class="container-fluid pb-6">
    <div class="row">
      <div class="col-md-2">
        <h3>
          <b>Sidebar</b>
        </h3>
        <button onclick="toggleTags()" class="btn-secondary ms-0 mb-3">Tags</button>
        <form method="get" action="{% url 'python_problems:index' %}">
          <input name="query"
                 class="px-2 py-2 mb-2"
                 type="text"
                 value="{{ query }}"
                 placeholder="Search by tag or title">
          <div class="btn-group btn-group-horizontal gap-2">
            <button class="btn btn-primary mb-2 px-2">Search</button>
            <a class="btn btn-warning mb-2 p-1"
               href="{% url 'python_problems:index' %}"
               role="button">Clear search</a>
          </div>
        </form>
      </div>
      <div class="col-md-9">
        {% if problem_list %}
          <ul>
            {% for problem in problem_list %}
              <li>
                <div class="problem-container flex">
                  <a href="{% url 'python_problems:detail' problem.id %}">{{ problem.title }}</a>,
                  (<a href="{% url 'python_problems:problem-update' problem.id %}">Update</a> |
                  <a href="{% url 'python_problems:problem-delete' problem.id %}">Delete</a>)
                  {% comment %}<a href="{% url 'python_problems:detail' problem.id %}" class="tags" style="display: none">, ({{ problem.tags.all|join:', ' }})</a>{% endcomment %}
                  {% for tag in problem.tags.all %}
                    <a href="{% url 'python_problems:index' %}?query={{ tag }}"
                       class="tags"
                       style="display: none">, {{ tag }}</a>
                  {% endfor %}
                </div>
                <hr>
              </li>
            {% endfor %}
          </ul>
        {% else %}
          <p>No python problems available.</p>
        {% endif %}
      </div>
    </div>
  </div>
  <script>
  function toggleTags() {
    var tags = document.querySelectorAll(".tags");
    for (var i = 0; i < tags.length; i++) {
      if (tags[i].style.display === "none") {
        tags[i].style.display = "block";
      } else {
        tags[i].style.display = "none";
      }
    }
  }
  </script>
{% endblock content %}
